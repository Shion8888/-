<script>
const pipLayouts = {
  1:[4],2:[0,8],3:[0,4,8],
  4:[0,2,6,8],5:[0,2,4,6,8],6:[0,2,3,5,6,8]
};

let rolling = false;

function rand() {
  return Math.floor(Math.random() * 6) + 1;
}

function renderDie(el, val) {
  el.innerHTML = [...Array(9)].map((_, i) =>
    `<span class="pip${pipLayouts[val].includes(i) ? ' on' : ''}"></span>`
  ).join("");
}

function roll() {
  if (rolling) return;
  rolling = true;

  const result = document.getElementById("result");
  result.textContent = "";

  const dices = [d1, d2, d3];
  const values = dices.map(() => rand());

  dices.forEach((d, i) => {
    d.className = "dice";
    d.style.left = `${60 + i * 120}px`;
    d.style.opacity = 1;
    renderDie(d, values[i]);
    void d.offsetWidth;
    d.classList.add("throw");
  });

  setTimeout(() => {
    dices.forEach(d => d.classList.add("inbowl"));
  }, 900);

  setTimeout(() => {
    rolling = false;
    judge(values);
  }, 1600);
}

function judge(values) {
  const r = document.getElementById("result");
  const [a,b,c] = values;
  const s = [...values].sort();

  if (a === b && b === c) {
    r.textContent = a === 1 ? "ğŸ‰ ãƒ”ãƒ³ã‚¾ãƒ­ï¼ˆæœ€å¼·ï¼‰" : "âš¡ ã‚¢ãƒ©ã‚·";
    return;
  }

  if (s.join() === "1,2,3") {
    r.textContent = "ğŸ’€ ãƒ’ãƒ•ãƒŸï¼ˆæœ€å¼±ï¼‰";
    return;
  }

  if (s.join() === "4,5,6") {
    r.textContent = "ğŸ”¥ ã‚·ã‚´ãƒ­";
    return;
  }

  if (a === b || b === c || a === c) {
    const point = a === b ? c : a === c ? b : a;
    r.textContent = `ğŸ‘‰ å½¹ã‚ã‚Šï¼š${point}`;
    return;
  }

  r.textContent = "ğŸ˜ å½¹ãªã—";
}
</script>
